{% extends 'sec.html' %}
{% block head %}
<link rel="stylesheet" href="/static/css/catalogs.css">
<title>Noble paints | Catalogs</title>
<style>
  header.subpage {
    background: url("/static/images/header12.jpg") center/cover no-repeat;
  }
  .catalogs-container {
    padding: 3rem 0;
  }
  .catalogs-filters {
    background: #f5f7fb;
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    box-shadow: 0 8px 18px rgba(18, 38, 63, 0.08);
  }
  .catalogs-filters form {
    display: grid;
    gap: 1rem;
  }
  @media(min-width: 768px) {
    .catalogs-filters form {
      grid-template-columns: repeat(4, minmax(0, 1fr));
      align-items: end;
    }
    .catalogs-filters form .full-row {
      grid-column: 1 / -1;
    }
  }
  .filter-label {
    display: block;
    font-weight: 600;
    margin-bottom: 0.35rem;
  }
  .lang-switch {
    display: inline-flex;
    gap: 0.5rem;
    background: #fff;
    padding: 0.35rem;
    border-radius: 999px;
    border: 1px solid #dbe2f1;
  }
  .lang-switch button {
    border: none;
    background: transparent;
    padding: 0.4rem 0.9rem;
    border-radius: 999px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .lang-switch button.is-active {
    background: #1d4ed8;
    color: #fff;
    box-shadow: 0 6px 16px rgba(29, 78, 216, 0.25);
  }
  .catalogs-summary {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
  }
  .catalogs-summary span {
    font-weight: 500;
    color: #4a587a;
  }
  .catalogs-grid {
    display: grid;
    gap: 1.5rem;
  }
  @media(min-width: 768px) {
    .catalogs-grid {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }
  @media(min-width: 1200px) {
    .catalogs-grid {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
  }
  .catalog-card {
    display: flex;
    flex-direction: column;
    background: #fff;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .catalog-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 16px 32px rgba(15, 23, 42, 0.18);
  }
  .catalog-card__image {
    aspect-ratio: 4 / 5;
    background: #f2f3f7;
  }
  .catalog-card__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }
  .catalog-card__body {
    padding: 1.25rem;
    display: flex;
    flex-direction: column;
    flex: 1;
  }
  .catalog-card__title {
    font-size: 1.1rem;
    margin: 0;
    margin-bottom: 0.75rem;
    color: #1f2a44;
  }
  .catalog-card__meta {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem 1rem;
    margin-bottom: 1rem;
    font-size: 0.9rem;
    color: #5a6789;
  }
  .catalog-card__meta span {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
  }
  .catalog-card__meta svg {
    width: 16px;
    height: 16px;
    color: #1d4ed8;
  }
  .catalog-card__actions {
    margin-top: auto;
    display: flex;
    justify-content: flex-start;
  }
  .catalog-card__actions a {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: #1d4ed8;
    color: #fff;
    padding: 0.55rem 1.1rem;
    border-radius: 999px;
    font-weight: 600;
    text-decoration: none;
    transition: background 0.2s ease;
  }
  .catalog-card__actions a:hover {
    background: #163fa1;
  }
  .empty-state {
    text-align: center;
    padding: 3rem 1rem;
    background: #f8fafc;
    border-radius: 12px;
    border: 1px dashed #cbd5f5;
    color: #5a6789;
  }
  .catalog-pagination {
    margin-top: 2.5rem;
    display: flex;
    justify-content: center;
  }
  .catalog-pagination ul {
    list-style: none;
    display: flex;
    gap: 0.5rem;
    padding: 0;
    margin: 0;
  }
  .catalog-pagination a,
  .catalog-pagination span {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 38px;
    height: 38px;
    border-radius: 50%;
    border: 1px solid #dbe2f1;
    color: #1f2a44;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.2s ease;
  }
  .catalog-pagination a:hover {
    background: #1d4ed8;
    color: #fff;
    border-color: #1d4ed8;
  }
  .catalog-pagination .is-active {
    background: #1d4ed8;
    color: #fff;
    border-color: #1d4ed8;
    cursor: default;
  }
  .catalog-pagination .disabled span {
    opacity: 0.5;
    cursor: not-allowed;
  }
</style>
{% endblock %}

{% block content %}
<header class="subpage medium">
  <div class="breadcrubms">
    <div class="container2">
      <div class="row">
        <div class="col-md-12">
          <nav>
            <a href="/" class="home">
              <svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="home-alt"
                   role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"
                   class="svg-inline--fa fa-home-alt fa-w-18">
                <path fill="currentColor"
                      d="M541 229.16l-232.85-190a32.16 32.16 0 0 0-40.38 0L35 229.16a8 8 0 0 0-1.16 11.24l10.1 12.41a8 8 0 0 0 11.2 1.19L96 220.62v243a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-128l64 .3V464a16 16 0 0 0 16 16l128-.33a16 16 0 0 0 16-16V220.62L520.86 254a8 8 0 0 0 11.25-1.16l10.1-12.41a8 8 0 0 0-1.21-11.27zm-93.11 218.59h.1l-96 .3V319.88a16.05 16.05 0 0 0-15.95-16l-96-.27a16 16 0 0 0-16.05 16v128.14H128V194.51L288 63.94l160 130.57z">
                </path>
              </svg>
              <span class="text">Catalogs</span>
            </a>
            <span class="text">Catalogs</span>
          </nav>
        </div>
      </div>
    </div>
  </div>
  <div class="container2">
    <h1 class="text">
      <span class="text-bg-red text">Catalogs</span>
    </h1>
  </div>
</header>

<section class="catalogs-container">
  <div class="container2">
    <div class="catalogs-filters">
      <form id="catalogFilters" method="get">
        <input type="hidden" name="page" id="pageInput" value="{{ page }}">
        <input type="hidden" name="lang" id="langInput" value="{{ lang }}">

        <div class="filter-group">
          <span class="filter-label">{{ 'Language' if lang == 'en' else 'اللغة' }}</span>
          <div class="lang-switch" role="group" aria-label="Language selector">
            <button type="button" data-lang="en" class="lang-btn{% if lang == 'en' %} is-active{% endif %}">English</button>
            <button type="button" data-lang="ar" class="lang-btn{% if lang == 'ar' %} is-active{% endif %}">العربية</button>
          </div>
        </div>

        <div class="filter-group">
          <label for="filterCategory" class="filter-label">{{ 'Category' if lang == 'en' else 'الفئة' }}</label>
          <select id="filterCategory" name="category" class="form-control" data-auto-submit>
            <option value="All"{% if category in ['All', None, '', 'null'] %} selected{% endif %}>{{ 'All' if lang == 'en' else 'الكل' }}</option>
            {% for cat in categories %}
              <option value="{{ cat.id }}"
                      {% if category|string == cat.id|string %}selected{% endif %}>
                {{ cat.name if lang == 'en' else (cat.nameArabic or cat.name) }}
              </option>
            {% endfor %}
          </select>
        </div>

        <div class="filter-group">
          <label for="filterCountry" class="filter-label">{{ 'Country' if lang == 'en' else 'الدولة' }}</label>
          <select id="filterCountry" name="country" class="form-control" data-auto-submit>
            {% for option in country_options %}
              <option value="{{ option }}"
                      {% if (country or 'All') == option %}selected{% endif %}>
                {{ option if lang == 'en' else ('الكل' if option == 'All' else option) }}
              </option>
            {% endfor %}
          </select>
        </div>

        <div class="filter-group full-row">
          <label for="filterSearch" class="filter-label">{{ 'Search' if lang == 'en' else 'بحث' }}</label>
          <div class="input-group">
            <input type="text" id="filterSearch" name="search" class="form-control" value="{{ search }}" placeholder="{{ 'Catalog name' if lang == 'en' else 'اسم الكتالوج' }}">
            <button type="submit" class="btn btn-gray-800" id="filterSubmit">{{ 'Apply' if lang == 'en' else 'تطبيق' }}</button>
          </div>
        </div>
      </form>
    </div>

    <div class="catalogs-summary">
      <span>
        {% if total_items %}
          {{ total_items }} {{ 'catalog(s) found' if lang == 'en' else 'كتالوج' }}
        {% else %}
          {{ 'No catalogs found' if lang == 'en' else 'لا يوجد كتالوجات' }}
        {% endif %}
      </span>
      {% if search %}
        <span>{{ 'Search' if lang == 'en' else 'البحث' }}: “{{ search }}”</span>
      {% endif %}
    </div>

    {% if items %}
      <div class="catalogs-grid">
        {% for item in items %}
          <article class="catalog-card">
            <div class="catalog-card__image">
              <img src="{{ item.image_url }}" alt="{{ item.name }}" loading="lazy"
                   onerror="this.src='/static/images/default-catalog.jpg'">
            </div>
            <div class="catalog-card__body">
              <h3 class="catalog-card__title">{{ item.name }}</h3>
              <div class="catalog-card__meta">
                <span>
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2a10 10 0 00-6.32 17.75l-1.6 1.6a1 1 0 001.42 1.42l1.6-1.6A10 10 0 1012 2zm0 18a8 8 0 118-8 8 8 0 01-8 8z"></path>
                    <path d="M12.75 7h-1.5v5.25l4.5 2.67.75-1.23-3.75-2.19z"></path>
                  </svg>
                  {{ item.category_name }}
                </span>
                <span>
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 112.5-2.5 2.5 2.5 0 01-2.5 2.5z"></path>
                  </svg>
                  {{ item.country }}
                </span>
              </div>
              <div class="catalog-card__actions">
                {% if item.download_url %}
                  <a href="{{ item.download_url }}" target="_blank" rel="noopener">
                    {{ 'View' if lang == 'en' else 'عرض' }}
                  </a>
                {% else %}
                  <span>{{ 'No file available' if lang == 'en' else 'لا يوجد ملف متاح' }}</span>
                {% endif %}
              </div>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty-state">
        {{ 'We could not find catalogs that match your filters.' if lang == 'en' else 'لم يتم العثور على كتالوجات مطابقة للمرشحات المختارة.' }}
      </div>
    {% endif %}

    {% if total_pages > 1 %}
      {% set query_prefix = query_without_page + ('&' if query_without_page else '') %}
      <nav class="catalog-pagination" aria-label="Catalog pagination">
        <ul>
          <li class="{% if page <= 1 %}disabled{% endif %}">
            {% if page <= 1 %}
              <span>‹</span>
            {% else %}
              <a href="?{{ query_prefix }}page={{ page - 1 }}">‹</a>
            {% endif %}
          </li>
          {% for number in range(1, total_pages + 1) %}
            <li>
              {% if number == page %}
                <span class="is-active">{{ number }}</span>
              {% else %}
                <a href="?{{ query_prefix }}page={{ number }}">{{ number }}</a>
              {% endif %}
            </li>
          {% endfor %}
          <li class="{% if page >= total_pages %}disabled{% endif %}">
            {% if page >= total_pages %}
              <span>›</span>
            {% else %}
              <a href="?{{ query_prefix }}page={{ page + 1 }}">›</a>
            {% endif %}
          </li>
        </ul>
      </nav>
    {% endif %}
  </div>
</section>

<script src="/static/js/languages/catalogs.js" defer></script>
<script src="/static/js/catalogs.js" defer></script>
{% endblock %}
